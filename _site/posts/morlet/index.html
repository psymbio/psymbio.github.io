<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

<head>
    <meta charset="utf-8">
    <title>
        Morlet Wavelets &ndash; The Brain Archive
    </title>
    <link rel="preload" as="font" href="/fonts/MessinaSans-Regular.woff2" type="font/woff2" crossorigin="messinasans">
    <link rel="preload" as="font" href="/fonts/MessinaSans-SemiBold.woff2" type="font/woff2" crossorigin="messinasans-semi">
    <link rel="preload" as="font" href="/fonts/fira-mono-v9-latin-regular.woff2" type="font/woff2" crossorigin="fira">
    <meta name="author" content="psymbio" />
    <meta name="description" content="psymbio's blog" />
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <link rel="alternate" type="application/rss+xml" href="/atom.xml" />
    <link rel="stylesheet" href="/css/base.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="/css/post.css" type="text/css" media="screen, projection" />
    <link rel="shortcut icon" type="image/x-icon" href="/icons/icon.png" />
    <link rel="icon" type="image/png" href="/icons/icon.png">
    <link rel="manifest" href="/manifest.json">

    <!-- See https://goo.gl/OOhYW5 -->
    <link rel="manifest" href="manifest.json">

    <!-- See https://goo.gl/qRE0vM -->
    <meta name="theme-color" content="#C1272D">

    <!-- Add to homescreen for Chrome on Android. Fallback for manifest.json -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="psymbio's blog">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="psymbio's blog">

    <!-- Homescreen icons -->
    <link rel="apple-touch-icon" sizes="192x192" href="icons/icon.png">

    <!-- Tile icon for Windows 8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="icons/icon.png">
    <meta name="msapplication-TileColor" content="#C1272D">
    <meta name="msapplication-tap-highlight" content="no">

    <!-- Default twitter cards -->
    <meta name="twitter:card" content="psymbio's blog">
    <meta name="twitter:site" content="@psymbio">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="my-app">
    <meta property="og:image" content="icons/icon.png" />

    <!--clicky analytics-->

    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.1.2/es5/startup.js" integrity="sha512-umLk4jlqS6v3HF06nsUFlzLGh3yp1A9X+hhlGOEstnLdkphT8w0O8nJJi2Pf28kfIFQvYzMg7ODPluFlkc/WzQ==" crossorigin="anonymous"></script>

    <!--flowcharts-->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true
        });
    </script>
    <!--2d plots-->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <!--3d plots-->
    <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
    <!--python for browser: brython
<script type="text/javascript" src="/scripts/brython.js"></script>
<script type="text/javascript" src="/scripts/brython_stdlib.js"></script>
--->


    <!--copy code to clipboard-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
    <script src="/assets/scripts/copycode.js"></script>

    <!--particles on the background-->
    <script src="/assets/scripts/particle.js"></script>

    <link rel="stylesheet" type="text/css" href="http://tikzjax.com/v1/fonts.css">
    <script src="http://tikzjax.com/v1/tikzjax.js"></script>
    <meta name="google-site-verification" content="3PIlzxg_Fq6uuVEqKvNXrVj8NuWqIA9_hqCxWLcnU-4" />
    <!--
<nav>
  <ul>
      <li><a href="/">Blog</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/contact">Contact</a></li>
  </ul>
</nav>
-->
</head>

<body>
    <div class="top-line"></div>
    <div class="container">
        <section class="shore">
            <header class="sidebar">
    <link rel="preload" as="font" href="/fonts/MessinaSans-Regular.woff2" type="font/woff2" crossorigin="messinasans">
    <link rel="preload" as="font" href="/fonts/MessinaSans-SemiBold.woff2" type="font/woff2" crossorigin="messinasans-semi">
    <link rel="preload" as="font" href="/fonts/fira-mono-v9-latin-regular.woff2" type="font/woff2" crossorigin="fira">
    <a href="/">
        <img src="/images/title.png" height="250" width="250" class="avatar" />
    </a>
    <!-- Global site tag (gtag.js) - Google Analytics -->
</header>
<link rel="stylesheet" href="/css/post.css" type="text/css" media="screen, projection" />
<link rel="preload" as="font" href="/fonts/MessinaSans-Regular.woff2" type="font/woff2" crossorigin="messinasans">
<link rel="preload" as="font" href="/fonts/MessinaSans-SemiBold.woff2" type="font/woff2" crossorigin="messinasans-semi">
<link rel="preload" as="font" href="/fonts/fira-mono-v9-latin-regular.woff2" type="font/woff2" crossorigin="fira">
<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<script src="/assets/scripts/copycode.js"></script>
<section class="content">
    <section class="byline">
        November 24, 2021
    </section>
    <h1>Morlet Wavelets</h1>
    <br> <h2 id="morlet-wavelets-in-time-and-frequency-usage-and-implementation">Morlet Wavelets in Time and Frequency (Usage and Implementation)</h2>

<p>We might lose data while converting the signals of EEG from the time to frequency domain. That‚Äôs a short-coming of static spectral analyses, and so to be able to extract frequency specific information over time we use wavelet convolution.</p>

<p>What‚Äôs a wavelet?</p>

<div class="wikipedia">
A wavelet is a wave-like oscillation with an amplitude that begins at zero, increases or decreases, and then returns to zero one or more times. Wavelets are termed a "brief oscillation". A taxonomy of wavelets has been established, based on the number and direction of its pulses. Wavelets are imbued with specific properties that make them useful for signal processing.
</div>

<iframe src="https://www.desmos.com/calculator/lbzmlosf4g" width="100%" style="min-height:400px"></iframe>

<p>Yeah, there‚Äôs a bit of cheating, we can‚Äôt graph complex numbers in desmos and I‚Äôll probably have to look into plotting these another way, but for now the only online substitute is visit <a href="https://jutanium.github.io/ComplexNumberGrapher/">this</a> and type this: \(\cos (2\pi z)+z\sin (2\pi z)\) (from Euler‚Äôs formula) and like all things complex, you must imagine yourself multiplying it with a gaussian and creating a morlet.</p>

<p>Euler‚Äôs formula for the basic waves \(e^{2\pi i \theta}\) is \(e^{2\pi i \theta} = cos(2\pi\theta) + i sin(2\pi\theta)\).</p>

<p>The Arctic Monkeys logo might be more mathematic than you think.</p>

<iframe src="https://www.desmos.com/calculator/uuv2ikwvev" width="100%" style="min-height:400px"></iframe>

<p>„Åã„Çè„ÅÑ„ÅÑ„Åß„Åô„Å≠üíÆ</p>

<p>Requirements for a wavelet: it integrates to zero or the sum total is zero over time and it tapers to zero in the beginning and the end.</p>

<p>Wavelets provide temporal specificity when used as weighting functions for signals, as when these signals are convoluted(sliding dot product between the kernel and the section of signal it‚Äôs aligned with) with the kernel(in this case the morlet wavelet).</p>

<figure>
<img alt="separate signals" src="/images/2021/ants/multichannel.gif" height="80%" width="80%" />
<figcaption align="center">Multi-channel Convolution</figcaption>
</figure>

<p>So now, unlike weighting the signal with a normal sine wave, weighting with the morlet retains temporal information because it tapers out as well as the spectral information(something like a fourier transform, just better).</p>

<p><a href="https://e2eml.school/convolution_one_d.html">Convolution in one dimension for neural networks</a></p>

<p><a href="http://www.svcl.ucsd.edu/courses/ece271B-F09/handouts/DPK.pdf">Dot-product kernels in ml</a>
s
<a href="https://www.dcs.bbk.ac.uk/~ale/dsta/dsta-2/dsta-2018-19-zaki-meira-ch5-excerpt-v2.pdf">Kernel Methods</a></p>

    <script src="https://utteranc.es/client.js" repo="psymbio/psymbio.github.io" issue-term="pathname" theme="github-dark-orange" crossorigin="anonymous" async>
    </script>
</section>

</section>
<section class="shore">
    <section class="content">
        <div class="footer"></div>
        <section class="thanks">
            <span>That sentence that goes before giving my email to strangers: <a href="mailto: psymbio@gmail.com">psymbio@gmail.com</a></span>
        </section>
        </div>
    </section>
</section>
<br>
<br>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<style>
    .videoWrapper {
        position: relative;
        padding-bottom: 56.333%;
        height: 0;
        background: black;
    }
    
    .videoWrapper iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: 0;
    }
</style>

<script>
    function get_youtube_id(url) {
        var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
        return (url.match(p)) ? RegExp.$1 : false;
    }

    function vimeo_embed(url, el) {
        var id = false;
        $.ajax({
            url: 'https://vimeo.com/api/oembed.json?url=' + url,
            async: true,
            success: function(response) {
                if (response.video_id) {
                    id = response.video_id;
                    if (url.indexOf('autoplay=1') !== -1) var autoplay = 1;
                    else var autoplay = 0;
                    if (url.indexOf('loop=1') !== -1) var loop = 1;
                    else var loop = 0;
                    var theInnerHTML = '<div class="videoWrapper"><iframe src="https://player.vimeo.com/video/' + id + '/?byline=0&title=0&portrait=0';
                    if (autoplay == 1) theInnerHTML += '&autoplay=1';
                    if (loop == 1) theInnerHTML += '&loop=1';
                    theInnerHTML += '" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>';
                    el.innerHTML = theInnerHTML;
                }
            }
        });
    }

    function video_embed() {
        var p = document.getElementsByTagName('p');
        for (var i = 0; i < p.length; i++) {
            //check if this is an external url (that starts with https:// or http://
            if (p[i].innerHTML.indexOf("http://") == 0 ||
                p[i].innerHTML.indexOf("https://") == 0) {
                var youtube_id = get_youtube_id(p[i].innerHTML);
                if (youtube_id) {
                    if (p[i].innerHTML.indexOf('autoplay=1') !== -1) var autoplay = 1;
                    else var autoplay = 0;
                    if (p[i].innerHTML.indexOf('loop=1') !== -1) var loop = 1;
                    else var loop = 0;
                    var theInnerHTML = '<div class="videoWrapper"><iframe width="720" height="420" src="https://www.youtube.com/embed/' + youtube_id + '?rel=0&showinfo=0';
                    if (autoplay == 1) theInnerHTML += '&autoplay=1';
                    if (loop == 1) theInnerHTML += '&loop=1&playlist=' + youtube_id + '&version=3';
                    if (p[i].innerHTML.indexOf('start=') !== -1) theInnerHTML += '&start=' + p[i].innerHTML.substring(p[i].innerHTML.indexOf('start=') + 6);
                    theInnerHTML += '" frameborder="0" allowfullscreen></iframe></div>';
                    p[i].innerHTML = theInnerHTML;
                }
                if (p[i].innerHTML.indexOf('vimeo.com') !== -1) {
                    //ask vimeo for the id and place the embed
                    vimeo_embed(p[i].innerHTML, p[i]);
                }
            }
        }
    }
    video_embed();

    function mp3_embed() {
        var p = document.getElementsByTagName('p');
        for (var i = 0; i < p.length; i++) {
            if (p[i].innerHTML.indexOf('.mp3') !== -1) {
                var str = p[i].innerHTML.split('?');
                if (str.length == 1) str[1] = '';
                var str1 = str[1];
                str1 = str1.replace('&', '').replace('&', '');
                str1 = str1.replace('autoplay=1', '').replace('autoplay=0', '');
                str1 = str1.replace('loop=1', '').replace('loop=0', '');
                str1 = str1.replace('controls=0', '').replace('controls=1', '');

                if (str[0].lastIndexOf('.mp3', str[0].length - 4) === str[0].length - 4 && str1.length == 0) {
                    if (str[1].indexOf('autoplay=1') !== -1) var autoplay = 1;
                    else var autoplay = 0;
                    if (str[1].indexOf('loop=1') !== -1) var loop = 1;
                    else var loop = 0;
                    if (str[1].indexOf('controls=0') !== -1) var controls = 0;
                    else var controls = 1;
                    var newInnerHTML = '<audio';
                    if (autoplay == 1) newInnerHTML += ' autoplay';
                    if (loop == 1) newInnerHTML += ' loop';
                    if (controls == 1) newInnerHTML += ' controls';
                    newInnerHTML += '><source src="' + str[0] + '" type="audio/mpeg">Your browser does not support the audio element.</audio>';
                    p[i].innerHTML = newInnerHTML;
                }
            }
        }
    }
    mp3_embed();
</script>
<script>
    ! function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0],
            p = /^http:/.test(d.location) ? 'http' : 'https';
        if (!d.getElementById(id)) {
            js = d.createElement(s);
            js.id = id;
            js.src = p + '://platform.twitter.com/widgets.js';
            fjs.parentNode.insertBefore(js, fjs);
        }
    }(document, 'script', 'twitter-wjs');
</script>

            <section class="shore">
    </div>
</body>
<script>
    'use strict';
    var head = document.head;
    var link = document.createElement('link');
    link.type = 'text/css';
    link.rel = 'stylesheet';
    link.href = '/css/pygments.css'
    head.appendChild(link);
</script>

</html>